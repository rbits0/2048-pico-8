pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
#include cell.lua
#include board.lua

-- main.p8

function _init()
    modify_palette()
    printh(" ")

    board = Board.new()
end


function _update()
    if btnp(⬅️) then
        board:move(LEFT)
    elseif btnp(➡️) then
        board:move(RIGHT)
    elseif btnp(⬆️) then
        board:move(UP)
    elseif btnp(⬇️) then
        board:move(DOWN)
    end
end


function _draw()
    cls()
    -- map(0, 0)
    
    draw_background()
    board:draw()
    draw_score()
end


function modify_palette()
    pal(2, -1, 1)
    pal(4, -2, 1)
    pal(9, -8, 1)
    pal(10, -14, 1)
    pal(12, -15, 1)
    pal(13, -13, 1)
    pal(14, -5, 1)
    
    -- background colour
    pal(6, -10, 1)
end


function draw_background()
    rectfill(0, 0, 127, 127, 6)

    for row=1, NUM_ROWS do
        for column=1, NUM_COLUMNS do
            local x, y = calculate_position(row, column)
            draw_cell(x, y, "", 32)
        end
    end
end


function draw_score()
    print(board.score, 4, 4, 7)
end






__gfx__
000000000000000000000000077777777777777077777777aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000
000000000000077777700000077777777777777077777777aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000
007007000007777777777000077777777777777077777777aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000
000770000077777777777700007777777777770077777777aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000
000770000077777777777700007777777777770077777777aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000
007007000777777777777770000777777777700077777777aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000
000000000777777777777770000007777770000077777777aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000
000000000777777777777770000000000000000077777777aaaaaaaa000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000007777777077777777077777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777077777777077777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777077777777077777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777077777777077777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777077777777077777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777077777777077777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777077777777077777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000777777777777777000000000077777770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000005555550000055555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000555555555500055555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000005555555555550055555555555555555555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000055555555555555005555555555555505555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000055555555555555005555555555555505555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555500555555555555005555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555500055555555550005555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555500000555555000005555555500000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555555555555555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555555555555555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555555555555555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555555555555555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555555555555555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555555555555555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555555555555555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000555555555555555555555555555555550000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0600060006000600060006000600060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0006000600060006000600060006000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600060006000600060006000600060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0006000600060006000600060006000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600060006000600060006000600060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0006000600060006000600060006000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600060006000600060006000600060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0006000600060006000600060006000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600060006000600060006000600060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0006000600060006000600060006000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600060006000600060006000600060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0006000600060006000600060006000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600060006000600060006000600060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0006000600060006000600060006000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0600060006000600060006000600060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0006000600060006000600060006000600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
